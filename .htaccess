# 404 Error Handler
ErrorDocument 404 /404_fix.php

# Enable URL rewriting
RewriteEngine On

# Don't rewrite actual PHP files
RewriteCond %{REQUEST_FILENAME} \.php$
RewriteRule ^ - [L]

# Common URL fixes
RewriteRule ^adii/(.*)$ http://localhost:8080/$1 [R=301,L]
RewriteRule ^ac_project/(.*)$ http://localhost:8080/$1 [R=301,L]

# Handle common missing files (but not PHP files)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !\.php$
RewriteRule ^(.*)$ 404_fix.php [L]

# Security headers
Header always set X-Content-Type-Options nosniff
Header always set X-Frame-Options DENY
Header always set X-XSS-Protection "1; mode=block"

# CORS headers
Header always set Access-Control-Allow-Origin "*"
Header always set Access-Control-Allow-Methods "GET, POST, OPTIONS"
Header always set Access-Control-Allow-Headers "Content-Type, Accept"

# PHP settings
php_flag display_errors On
php_value error_reporting E_ALL
